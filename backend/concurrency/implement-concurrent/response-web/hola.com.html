<!doctype html>
<html lang="en">
<head>
    <noscript><meta http-equiv="refresh" content="0; url=https://www.hola.com" /></noscript>
    <meta charset="utf-8">
    <script>
        const getQueryParams = (param) => {
            let url = window.location.href;
            let regex = new RegExp('[?&]' + param + '=([^&#]*)', 'i');
            if(url.match(regex)) {
                return url.match(regex)[1];
            }
            return null;
        };

        let
            countryCode = '',
            domain = '',
            ajaxUrl = 'https://www.tuotrodiario.com/',
            request = new XMLHttpRequest()
        ;

        request.open('HEAD', ajaxUrl, false);
        request.send(null);
        if (request.getAllResponseHeaders().indexOf("countrycode") >= 0) {
            countryCode = request.getResponseHeader("countrycode");
            console.info('countrycode detected: ' + countryCode);
        }

        if (getQueryParams('countrycode') !== null) {
            countryCode = getQueryParams('countrycode');
            console.info('forced countrycode: ' + countryCode);
        }

        switch (countryCode.toLowerCase()) {
            case 'es':
                domain = 'www.hola.com';
                break;
            case 'us':
                domain = 'www.hola.com/us';
                break;
            case 'mx':
                domain = 'mx.hola.com';
                break;
            default:
                domain = 'www.hola.com';
                break;
        }

        const redirectUrl =
            window.location.protocol +
            '//' +
            domain +
            window.location.pathname +
            window.location.search
        ;

        if (window.location.href !== redirectUrl) {
            window.location.replace(redirectUrl);
        }
    </script>
<body>
</body>
</html>
